result_df$num_target <- as.numeric(result_df$num_target)
result_df$ppv <- as.numeric(result_df$ppv)
plot_ppv_numTargets <- ggplot(result_df, aes(x=num_target, y=ppv, colour=Tools)) +
geom_line() +
geom_point(alpha=1) +
theme(text = element_text(size=18)) + ylab("Precision") + xlab("Number of targets") +
theme(legend.position='none') +
scale_color_manual(values = c("XHMM"=hue_pal()(3)[3], "XHMM & CNV-Espresso"=hue_pal()(3)[1]))
return(plot_ppv_numTargets)
}
plot_ppv_vs_cnvFreq_all <- plot_ppv_cnvfreq(cnv_df)
plot_ppv_vs_cnvFreq_all
plot_ppv_numTargets_unionAsTP <- plot_ppv(rare_cnv_df)
plot_ppv_numTargets_unionAsTP
plot_ppv_numTargets_unionAsTP <- plot_ppv(rare_cnv_df)
library(ggplot2)
library(scales) # for color palette
plot_ppv_numTargets_unionAsTP <- plot_ppv(rare_cnv_df)
plot_ppv_numTargets_unionAsTP
grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all+remove("x.text"), nrow=1, ncol = 2)
rare_cnv_sq60 <- rare_cnv_df[which(rare_cnv_df$Q_SOME >=60), ]
plot_ppv_numTargets_unionAsTP_sq60 <- plot_ppv(rare_cnv_sq60)
plot_ppv_numTargets_unionAsTP_sq60
cnv_df
all_cnv_sq60 <- cnv_df[which(cnv_df$Q_SOME >=60), ]
all_cnv_sq60
plot_ppv_freq_sq60 <- plot_ppv_cnvfreq(all_cnv_sq60)
plot_ppv_freq_sq60
grid.arrange(plot_ppv_numTargets_unionAsTP_sq60, plot_ppv_freq_sq60+remove("x.text"), nrow=1, ncol = 2)
grid.arrange(plot_ppv_numTargets_unionAsTP_sq60, plot_ppv_freq_sq60+remove("legend"), nrow=1, ncol = 2)
grid.arrange(plot_ppv_numTargets_unionAsTP_sq60, plot_ppv_freq_sq60, nrow=1, ncol = 2)
plot_ppv_numTargets <- function(rare_cnv_df){
result_df <- data.frame(num_target=numeric(), ppv=numeric(), Tools=character(), stringsAsFactors = FALSE)
for(num_target in 1:20){
ppv_targets(rare_cnv_df, num_target)
#print(ppv_targets(rare_cnv_df, num_target))
result_df[nrow(result_df) + 1,] <- c(num_target, ppv_targets(rare_cnv_df, num_target)[1], 'XHMM')
result_df[nrow(result_df) + 1,] <- c(num_target, ppv_targets(rare_cnv_df, num_target)[2], 'XHMM & CNV-Espresso')
}
result_df$num_target <- as.numeric(result_df$num_target)
result_df$ppv <- as.numeric(result_df$ppv)
plot_ppv_numTargets <- ggplot(result_df, aes(x=num_target, y=ppv, colour=Tools)) +
geom_line() +
geom_point(alpha=1) +
theme(text = element_text(size=18)) + ylab("Precision") + xlab("Number of targets") +
theme(legend.position='none') +
scale_color_manual(values = c("XHMM"=hue_pal()(3)[3], "XHMM & CNV-Espresso"=hue_pal()(3)[1]))
return(plot_ppv_numTargets)
}
plot_ppv_numTargets_unionAsTP <- plot_ppv_numTargets(rare_cnv_df)
plot_ppv_numTargets_unionAsTP
grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, common.legend = TRUE, legend="bottom", nrow=1, ncol = 2)
grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, common.legend = TRUE, legend="bottom", nrow=1, ncol = 2)
grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, common.legend = TRUE, legend="bottom", nrow=1, ncol=2)
grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, nrow=1, ncol=2)#common.legend = TRUE, legend="bottom"
plot_ppv_numTargets <- ggplot(result_df, aes(x=num_target, y=ppv, colour=Tools)) +
geom_line() +
geom_point(alpha=1) +
theme(text = element_text(size=18)) + ylab("Precision") + xlab("Number of targets") +
theme(legend.position='bottom') +
scale_color_manual(values = c("XHMM"=hue_pal()(3)[3], "XHMM & CNV-Espresso"=hue_pal()(3)[1]))
return(plot_ppv_numTargets)
plot_ppv_numTargets <- function(rare_cnv_df){
result_df <- data.frame(num_target=numeric(), ppv=numeric(), Tools=character(), stringsAsFactors = FALSE)
for(num_target in 1:20){
ppv_targets(rare_cnv_df, num_target)
#print(ppv_targets(rare_cnv_df, num_target))
result_df[nrow(result_df) + 1,] <- c(num_target, ppv_targets(rare_cnv_df, num_target)[1], 'XHMM')
result_df[nrow(result_df) + 1,] <- c(num_target, ppv_targets(rare_cnv_df, num_target)[2], 'XHMM & CNV-Espresso')
}
result_df$num_target <- as.numeric(result_df$num_target)
result_df$ppv <- as.numeric(result_df$ppv)
plot_ppv_numTargets <- ggplot(result_df, aes(x=num_target, y=ppv, colour=Tools)) +
geom_line() +
geom_point(alpha=1) +
theme(text = element_text(size=18)) + ylab("Precision") + xlab("Number of targets") +
theme(legend.position='bottom') +
scale_color_manual(values = c("XHMM"=hue_pal()(3)[3], "XHMM & CNV-Espresso"=hue_pal()(3)[1]))
return(plot_ppv_numTargets)
}
plot_ppv_numTargets_unionAsTP <- plot_ppv_numTargets(rare_cnv_df)
plot_ppv_numTargets_unionAsTP
grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, common.legend = TRUE, legend="bottom", nrow=1, ncol=2)#
grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, common.legend = TRUE, nrow=1, ncol=2)#
grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, nrow=1, ncol=2)#
grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, nrow=1, ncol=2, legend="Bottom")#
library(ggpubr)
library(ggpubr)
grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, nrow=1, ncol=2)#
grid_arrange_shared_legend(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, nrow=1,ncol=2)
install.packages("grid_arrange_shared_legend")
grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, nrow=1, ncol=2)#
plot_ppv_numTargets_unionAsTP_sq60 <- plot_ppv_numTargets(rare_cnv_sq60)
plot_ppv_numTargets_unionAsTP_sq60
all_cnv_sq60 <- cnv_df[which(cnv_df$Q_SOME >=60), ]
plot_ppv_freq_sq60 <- plot_ppv_cnvfreq(all_cnv_sq60)
plot_ppv_freq_sq60
grid.arrange(plot_ppv_numTargets_unionAsTP_sq60, plot_ppv_freq_sq60, nrow=1, ncol = 2)
rare_cnv_df
rare_cnv_exlSD <- rare_cnv_df[which(rare_cnv_df$SD_region=='-' & rare_cnv_df$Q_SOME >=60),] #rare_cnv_df$`special_regions(clamms)`=='-' &
plot_ppv_numTargets_unionAsTP_exlSD <- plot_ppv_numTargets(rare_cnv_exlSD)
plot_ppv_numTargets_unionAsTP_exlSD
cnv_sd_sq60 <- cnv_df[which(cnv_df$SD_region=='-' & cnv_df$Q_SOME >=60), ]
plot_sd_sq60 <- plot_ppv_cnvfreq(cnv_sd_sq60)
plot_sd_sq60
plot_ppv_freq_sd_sq60 <- plot_ppv_cnvfreq(cnv_sd_sq60)
plot_ppv_freq_sd_sq60
grid.arrange(plot_ppv_numTargets_unionAsTP_exlSD, plot_ppv_freq_sd_sq60, nrow=1, ncol = 2)
plot_reduction_performance <- function(TP, TP_espresso, TN, TN_espresso){
summary_data <- data.frame(cnv_status=rep(c("True  Postive", "False Postive"), each=2),
Tools=rep(c("XHMM", "XHMM+CNVEspresso"),2),
num_cnv=c(TP, TP_espresso, TN, TN_espresso))
PLOT <- ggplot(summary_data, aes(x=Tools, y=num_cnv, fill=cnv_status)) +
geom_bar(stat="identity", width=0.7, position=position_dodge(width=0.7)) +
geom_text(aes(label=num_cnv), vjust=0, size=6, position = position_dodge(width = 0.7)) +
theme(text = element_text(size=18)) + ylab("Number of predictions") +
scale_fill_manual(values=c(hue_pal()(3)[3], hue_pal()(3)[1]))
return(PLOT)
}
TN_canvas_espresso
plot_reduction <- plot_reduction_performance(TP_canvas, TP_canvas_espresso, TN_canvas, TN_canvas_espresso)
plot_reduction
# a bar plot to show the reduction performance between and after CNV-espresso
plot_reduction_performance <- function(TP, TP_espresso, TN, TN_espresso){
summary_data <- data.frame(cnv_status=rep(c("True  Postive", "False Postive"), each=2),
Tools=rep(c("XHMM", "XHMM+CNVEspresso"),2),
num_cnv=c(TP, TP_espresso, TN, TN_espresso))
PLOT <- ggplot(summary_data, aes(x=Tools, y=num_cnv, fill=cnv_status)) +
geom_bar(stat="identity", width=0.7, position=position_dodge(width=0.7)) +
geom_text(aes(label=num_cnv), vjust=0, size=6, position = position_dodge(width = 0.7)) +
theme(text = element_text(size=18)) + ylab("Number of predictions") +
scale_fill_manual(values=c(hue_pal()(3)[3], hue_pal()(3)[1]))
return(PLOT)
}
plot_reduction_performance(TP_canvas, TP_canvas_espresso, TN_canvas, TN_canvas_espresso)
fig_redu_canvas <- plot_reduction_performance(TP_canvas, TP_canvas_espresso, TN_canvas, TN_canvas_espresso)
fig_redu_canvas
grid.arrange(plot_ppv_numTargets_unionAsTP_exlSD, plot_ppv_freq_sd_sq60, fig_redu_canvas, nrow=1, ncol = 3)
grid.arrange(fig_redu_canvas, plot_ppv_numTargets_unionAsTP_exlSD, plot_ppv_freq_sd_sq60 , nrow=1, ncol = 3)
grid.arrange( plot_ppv_numTargets_unionAsTP_exlSD,fig_redu_canvas, plot_ppv_freq_sd_sq60 , nrow=1, ncol = 3)
grid.arrange( plot_ppv_numTargets_unionAsTP_exlSD, plot_ppv_freq_sd_sq60, fig_redu_canvas, nrow=1, ncol = 3)
fig_redu_canvas
fig_redu_both <- plot_reduction_performance(TP_both, TP_both_espresso, TN_both, TN_both_espresso)
fig_redu_both
TP_both_espresso
fig_redu_both
TP_both
TN_both
TP_both_espresso
TN_both_espresso
fig_redu_both
TP_both <- nrow(rare_cnv_df[which(rare_cnv_df$TP_both!=""),])
TN_both <- nrow(rare_cnv_df[which(rare_cnv_df$TN_both!=""),])
rare_cnv_espresso_df <- rare_cnv_df[which(rare_cnv_df$Status=="Positive"),]
TP_both_espresso <- nrow(rare_cnv_espresso_df[which(rare_cnv_espresso_df$TP_both!=""),])
TN_both_espresso <- nrow(rare_cnv_espresso_df[which(rare_cnv_espresso_df$TN_both!=""),])
fig_redu_both <- plot_reduction_performance(TP_both, TP_both_espresso, TN_both, TN_both_espresso)
fig_redu_both
TP_both <- nrow(rare_cnv_df[which(rare_cnv_df$TP_both!=""),])
TP_both <- nrow(rare_cnv_df[which(rare_cnv_df$TP_intersection!=""),])
TN_both <- nrow(rare_cnv_df[which(rare_cnv_df$TN_both!=""),])
rare_cnv_espresso_df <- rare_cnv_df[which(rare_cnv_df$Status=="Positive"),]
TP_both_espresso <- nrow(rare_cnv_espresso_df[which(rare_cnv_espresso_df$TP_intersection!=""),])
TN_both_espresso <- nrow(rare_cnv_espresso_df[which(rare_cnv_espresso_df$TN_both!=""),])
fig_redu_both <- plot_reduction_performance(TP_both, TP_both_espresso, TN_both, TN_both_espresso)
fig_redu_both
TP_union <- nrow(rare_cnv_df[which(rare_cnv_df$TP_union!=""),])
TN_both  <- nrow(rare_cnv_df[which(rare_cnv_df$TN_both!=""),])
rare_cnv_espresso_df <- rare_cnv_df[which(rare_cnv_df$Status=="Positive"),]
TP_both_espresso <- nrow(rare_cnv_espresso_df[which(rare_cnv_espresso_df$TP_union!=""),])
TN_both_espresso <- nrow(rare_cnv_espresso_df[which(rare_cnv_espresso_df$TN_both!=""),])
fig_redu_intersection <- plot_reduction_performance(TP_both, TP_both_espresso, TN_both, TN_both_espresso)
fig_redu_intersection
fig_redu_intersection
TP_both <- nrow(rare_cnv_df[which(rare_cnv_df$TP_intersection!=""),])
TN_both <- nrow(rare_cnv_df[which(rare_cnv_df$TN_both!=""),])
rare_cnv_espresso_df <- rare_cnv_df[which(rare_cnv_df$Status=="Positive"),]
TP_both_espresso <- nrow(rare_cnv_espresso_df[which(rare_cnv_espresso_df$TP_intersection!=""),])
TN_both_espresso <- nrow(rare_cnv_espresso_df[which(rare_cnv_espresso_df$TN_both!=""),])
fig_redu_intersection <- plot_reduction_performance(TP_both, TP_both_espresso, TN_both, TN_both_espresso)
fig_redu_intersection
fig_redu_intersection
TP_union <- nrow(rare_cnv_df[which(rare_cnv_df$TP_union!=""),])
TN_both  <- nrow(rare_cnv_df[which(rare_cnv_df$TN_both!=""),])
rare_cnv_espresso_df <- rare_cnv_df[which(rare_cnv_df$Status=="Positive"),]
TP_both_espresso <- nrow(rare_cnv_espresso_df[which(rare_cnv_espresso_df$TP_union!=""),])
TN_both_espresso <- nrow(rare_cnv_espresso_df[which(rare_cnv_espresso_df$TN_both!=""),])
fig_redu_union <- plot_reduction_performance(TP_both, TP_both_espresso, TN_both, TN_both_espresso)
fig_redu_both
rare_cnv_df
fig_redu_both
fig_redu_union
TP_union <- nrow(rare_cnv_df[which(rare_cnv_df$TP_union!=""),])
TN_both  <- nrow(rare_cnv_df[which(rare_cnv_df$TN_both!=""),])
rare_cnv_espresso_df <- rare_cnv_df[which(rare_cnv_df$Status=="Positive"),]
TP_both_espresso <- nrow(rare_cnv_espresso_df[which(rare_cnv_espresso_df$TP_union!=""),])
TN_both_espresso <- nrow(rare_cnv_espresso_df[which(rare_cnv_espresso_df$TN_both!=""),])
fig_redu_union <- plot_reduction_performance(TP_both, TP_both_espresso, TN_both, TN_both_espresso)
TP_union <- nrow(rare_cnv_df[which(rare_cnv_df$TP_union!=""),])
TN_both  <- nrow(rare_cnv_df[which(rare_cnv_df$TN_both!=""),])
rare_cnv_espresso_df <- rare_cnv_df[which(rare_cnv_df$Status=="Positive"),]
TP_union_espresso <- nrow(rare_cnv_espresso_df[which(rare_cnv_espresso_df$TP_union!=""),])
TN_union  <- nrow(rare_cnv_df[which(rare_cnv_df$TN_both!=""),])
TP_union <- nrow(rare_cnv_df[which(rare_cnv_df$TP_union!=""),])
TN_union  <- nrow(rare_cnv_df[which(rare_cnv_df$TN_both!=""),])
rare_cnv_espresso_df <- rare_cnv_df[which(rare_cnv_df$Status=="Positive"),]
TP_union_espresso <- nrow(rare_cnv_espresso_df[which(rare_cnv_espresso_df$TP_union!=""),])
TN_union_espresso <- nrow(rare_cnv_espresso_df[which(rare_cnv_espresso_df$TN_both!=""),])
fig_redu_union <- plot_reduction_performance(TP_union, TP_union_espresso, TN_union, TN_union_espresso)
fig_redu_union
plot_ppv_numTargets <- function(rare_cnv_df){
result_df <- data.frame(num_target=numeric(), ppv=numeric(), Tools=character(), stringsAsFactors = FALSE)
for(num_target in 1:20){
ppv_targets(rare_cnv_df, num_target)
#print(ppv_targets(rare_cnv_df, num_target))
result_df[nrow(result_df) + 1,] <- c(num_target, ppv_targets(rare_cnv_df, num_target)[1], 'XHMM')
result_df[nrow(result_df) + 1,] <- c(num_target, ppv_targets(rare_cnv_df, num_target)[2], 'XHMM & CNV-Espresso')
}
result_df$num_target <- as.numeric(result_df$num_target)
result_df$ppv <- as.numeric(result_df$ppv)
plot_ppv_numTargets <- ggplot(result_df, aes(x=num_target, y=ppv, colour=Tools)) +
geom_line() +
geom_point(alpha=1) +
theme(text = element_text(size=18)) + ylab("Precision") + xlab("Number of targets") +
theme(legend.position='none') +
scale_color_manual(values = c("XHMM"=hue_pal()(3)[3], "XHMM & CNV-Espresso"=hue_pal()(3)[1]))
return(plot_ppv_numTargets)
}
plot_ppv_cnvfreq <- function(cnv_df){
result_df <- data.frame(cnv_frequency=numeric(), ppv=numeric(), Tools=character(), stringsAsFactors = FALSE)
for(num in 1:50){
cnv_frequency <- num/1000
ppv <- ppv_cnvfrequency(cnv_df, cnv_frequency)
print(paste0("CNV freq: ",ppv*100,"%"))
result_df[nrow(result_df) + 1,] <- c(cnv_frequency, ppv[1], 'XHMM')
result_df[nrow(result_df) + 1,] <- c(cnv_frequency, ppv[2], 'XHMM & CNV-Espresso')
}
result_df$cnv_frequency <- as.numeric(result_df$cnv_frequency)
result_df$ppv <- as.numeric(result_df$ppv)
plot_ppv_cnvfreq <- ggplot(result_df, aes(x=cnv_frequency, y=ppv, colour=Tools)) +
geom_point(alpha=1) +
stat_smooth(method=lm) + # Smooth the dots
#scale_color_hue(direction = -1) + # reverse the color
theme(text = element_text(size=18)) + ylab("Precision") + xlab("CNV frequency") +
theme(legend.position="none") +
scale_color_manual(values = c("XHMM"=hue_pal()(3)[3], "XHMM & CNV-Espresso"=hue_pal()(3)[1]))
return(plot_ppv_cnvfreq)
}
plot_ppv_numTargets_unionAsTP <- plot_ppv_numTargets(rare_cnv_df)
plot_ppv_numTargets_unionAsTP
plot_ppv_vs_cnvFreq_all <- plot_ppv_cnvfreq(cnv_df)
plot_ppv_vs_cnvFreq_all
grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, nrow=1, ncol=2)#
fig_redu_canvas
grid.arrange(plot_ppv_numTargets_unionAsTP_sq60, plot_ppv_freq_sq60,fig_redu_canvas,  nrow=1, ncol =3)
combo <- grid.arrange(plot_ppv_numTargets_unionAsTP_sq60, plot_ppv_freq_sq60,fig_redu_canvas,  nrow=1, ncol =3)
ggsave("./plots/combo.pdf", fig_redu_canvas, width=11, height=5, unit="in")
combo
ggsave("./plots/combo.pdf", combo, width=11, height=5, unit="in")
combo
plot_ppv_numTargets_unionAsTP_sq60
plot_ppv_numTargets_unionAsTP_sq60 <- plot_ppv_numTargets(rare_cnv_sq60)
plot_ppv_numTargets_unionAsTP_sq60
all_cnv_sq60 <- cnv_df[which(cnv_df$Q_SOME >=60), ]
plot_ppv_freq_sq60 <- plot_ppv_cnvfreq(all_cnv_sq60)
plot_ppv_freq_sq60
combo <- grid.arrange(plot_ppv_numTargets_unionAsTP_sq60, plot_ppv_freq_sq60,fig_redu_canvas,  nrow=1, ncol =3)
ggsave("./plots/combo.pdf", combo, width=11, height=5, unit="in")
combo
ggsave("./plots/combo.pdf", combo, width=17, height=5, unit="in")
combo
ggsave("./plots/combo.pdf", combo, width=20, height=5, unit="in")
combo
hist(rare_cnv_df$NUM_TARG,xlim=c(1,50),breaks=1000)
plot_ppv_numTargets_unionAsTP
plot_ppv_numTargets_unionAsTP <- plot_ppv_numTargets(rare_cnv_df)
plot_ppv_numTargets_unionAsTP
plot_ppv_numTargets_unionAsTP
plot_ppv_vs_cnvFreq_all
grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, nrow=1, ncol=2)#
combo <- grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, fig_redu_canvas,  nrow=1, ncol =3)
ggsave("./plots/combo.pdf", combo, width=20, height=5, unit="in")
combo
# A bar plot to show the reduction performance between and after CNV-espresso
plot_reduction_performance <- function(TP, TP_espresso, TN, TN_espresso){
summary_data <- data.frame(cnv_status=rep(c("True  Postive", "False Postive"), each=2),
Tools=rep(c("XHMM", "XHMM+CNVEspresso"),2),
num_cnv=c(TP, TP_espresso, TN, TN_espresso))
PLOT <- ggplot(summary_data, aes(x=Tools, y=num_cnv, fill=cnv_status)) +
geom_bar(stat="identity", width=0.7, position=position_dodge(width=0.7)) +
geom_text(aes(label=num_cnv), vjust=0, size=6, position = position_dodge(width = 0.7)) +
theme(text = element_text(size=18)) + ylab("Number of predictions") +
theme(legend.position = c(0.87, 0.25),legend.background = element_rect(fill = "white", color = "black")) +
scale_fill_manual(values=c(hue_pal()(3)[3], hue_pal()(3)[1]))
return(PLOT)
}
fig_redu_canvas <- plot_reduction_performance(TP_canvas, TP_canvas_espresso, TN_canvas, TN_canvas_espresso)
fig_redu_canvas
PLOT <- ggplot(summary_data, aes(x=Tools, y=num_cnv, fill=cnv_status)) +
geom_bar(stat="identity", width=0.7, position=position_dodge(width=0.7)) +
geom_text(aes(label=num_cnv), vjust=0, size=6, position = position_dodge(width = 0.7)) +
theme(text = element_text(size=18)) + ylab("Number of predictions") +
theme(legend.position = c(0.9, 0.9),legend.background = element_rect(fill = "white", color = "black")) +
scale_fill_manual(values=c(hue_pal()(3)[3], hue_pal()(3)[1]))
# A bar plot to show the reduction performance between and after CNV-espresso
plot_reduction_performance <- function(TP, TP_espresso, TN, TN_espresso){
summary_data <- data.frame(cnv_status=rep(c("True  Postive", "False Postive"), each=2),
Tools=rep(c("XHMM", "XHMM+CNVEspresso"),2),
num_cnv=c(TP, TP_espresso, TN, TN_espresso))
PLOT <- ggplot(summary_data, aes(x=Tools, y=num_cnv, fill=cnv_status)) +
geom_bar(stat="identity", width=0.7, position=position_dodge(width=0.7)) +
geom_text(aes(label=num_cnv), vjust=0, size=6, position = position_dodge(width = 0.7)) +
theme(text = element_text(size=18)) + ylab("Number of predictions") +
theme(legend.position = c(0.9, 0.9),legend.background = element_rect(fill = "white", color = "black")) +
scale_fill_manual(values=c(hue_pal()(3)[3], hue_pal()(3)[1]))
return(PLOT)
}
fig_redu_canvas <- plot_reduction_performance(TP_canvas, TP_canvas_espresso, TN_canvas, TN_canvas_espresso)
fig_redu_canvas
PLOT <- ggplot(summary_data, aes(x=Tools, y=num_cnv, fill=cnv_status)) +
geom_bar(stat="identity", width=0.7, position=position_dodge(width=0.7)) +
geom_text(aes(label=num_cnv), vjust=0, size=6, position = position_dodge(width = 0.7)) +
theme(text = element_text(size=18)) + ylab("Number of predictions") +
theme(legend.position = c(0.75, 0.75),legend.background = element_rect(fill = "white", color = "black")) +
scale_fill_manual(values=c(hue_pal()(3)[3], hue_pal()(3)[1]))
# A bar plot to show the reduction performance between and after CNV-espresso
plot_reduction_performance <- function(TP, TP_espresso, TN, TN_espresso){
summary_data <- data.frame(cnv_status=rep(c("True  Postive", "False Postive"), each=2),
Tools=rep(c("XHMM", "XHMM+CNVEspresso"),2),
num_cnv=c(TP, TP_espresso, TN, TN_espresso))
PLOT <- ggplot(summary_data, aes(x=Tools, y=num_cnv, fill=cnv_status)) +
geom_bar(stat="identity", width=0.7, position=position_dodge(width=0.7)) +
geom_text(aes(label=num_cnv), vjust=0, size=6, position = position_dodge(width = 0.7)) +
theme(text = element_text(size=18)) + ylab("Number of predictions") +
theme(legend.position = c(0.75, 0.75),legend.background = element_rect(fill = "white", color = "black")) +
scale_fill_manual(values=c(hue_pal()(3)[3], hue_pal()(3)[1]))
return(PLOT)
}
fig_redu_canvas <- plot_reduction_performance(TP_canvas, TP_canvas_espresso, TN_canvas, TN_canvas_espresso)
fig_redu_canvas
# A bar plot to show the reduction performance between and after CNV-espresso
plot_reduction_performance <- function(TP, TP_espresso, TN, TN_espresso){
summary_data <- data.frame(cnv_status=rep(c("True  Postive", "False Postive"), each=2),
Tools=rep(c("XHMM", "XHMM+CNVEspresso"),2),
num_cnv=c(TP, TP_espresso, TN, TN_espresso))
PLOT <- ggplot(summary_data, aes(x=Tools, y=num_cnv, fill=cnv_status)) +
geom_bar(stat="identity", width=0.7, position=position_dodge(width=0.7)) +
geom_text(aes(label=num_cnv), vjust=0, size=6, position = position_dodge(width = 0.7)) +
theme(text = element_text(size=18)) + ylab("Number of predictions") +
theme(legend.position = c(0.85, 0.75),legend.background = element_rect(fill = "white", color = "black")) +
scale_fill_manual(values=c(hue_pal()(3)[3], hue_pal()(3)[1]))
return(PLOT)
}
# A bar plot to show the reduction performance between and after CNV-espresso
plot_reduction_performance <- function(TP, TP_espresso, TN, TN_espresso){
summary_data <- data.frame(cnv_status=rep(c("True  Postive", "False Postive"), each=2),
Tools=rep(c("XHMM", "XHMM+CNVEspresso"),2),
num_cnv=c(TP, TP_espresso, TN, TN_espresso))
PLOT <- ggplot(summary_data, aes(x=Tools, y=num_cnv, fill=cnv_status)) +
geom_bar(stat="identity", width=0.7, position=position_dodge(width=0.7)) +
geom_text(aes(label=num_cnv), vjust=0, size=6, position = position_dodge(width = 0.7)) +
theme(text = element_text(size=18)) + ylab("Number of predictions") +
theme(legend.position = c(0.85, 0.75),legend.background = element_rect(fill = "white", color = "black")) +
scale_fill_manual(values=c(hue_pal()(3)[3], hue_pal()(3)[1]))
return(PLOT)
}
fig_redu_canvas <- plot_reduction_performance(TP_canvas, TP_canvas_espresso, TN_canvas, TN_canvas_espresso)
fig_redu_canvas
# A bar plot to show the reduction performance between and after CNV-espresso
plot_reduction_performance <- function(TP, TP_espresso, TN, TN_espresso){
summary_data <- data.frame(cnv_status=rep(c("True  Postive", "False Postive"), each=2),
Tools=rep(c("XHMM", "XHMM+CNVEspresso"),2),
num_cnv=c(TP, TP_espresso, TN, TN_espresso))
PLOT <- ggplot(summary_data, aes(x=Tools, y=num_cnv, fill=cnv_status)) +
geom_bar(stat="identity", width=0.7, position=position_dodge(width=0.7)) +
geom_text(aes(label=num_cnv), vjust=0, size=6, position = position_dodge(width = 0.7)) +
theme(text = element_text(size=18)) + ylab("Number of predictions") +
theme(legend.position = c(0.85, 0.85),legend.background = element_rect(fill = "white", color = "black")) +
scale_fill_manual(values=c(hue_pal()(3)[3], hue_pal()(3)[1]))
return(PLOT)
}
fig_redu_canvas <- plot_reduction_performance(TP_canvas, TP_canvas_espresso, TN_canvas, TN_canvas_espresso)
fig_redu_canvas
PLOT <- ggplot(summary_data, aes(x=Tools, y=num_cnv, fill=cnv_status)) +
geom_bar(stat="identity", width=0.7, position=position_dodge(width=0.7)) +
geom_text(aes(label=num_cnv), vjust=0, size=6, position = position_dodge(width = 0.7)) +
theme(text = element_text(size=18)) + ylab("Number of predictions") +
theme(legend.position = c(0.85, 0.85),legend.background = element_rect(fill = "white", color = "black"), legend.title = 'none') +
scale_fill_manual(values=c(hue_pal()(3)[3], hue_pal()(3)[1]))
# A bar plot to show the reduction performance between and after CNV-espresso
plot_reduction_performance <- function(TP, TP_espresso, TN, TN_espresso){
summary_data <- data.frame(cnv_status=rep(c("True  Postive", "False Postive"), each=2),
Tools=rep(c("XHMM", "XHMM+CNVEspresso"),2),
num_cnv=c(TP, TP_espresso, TN, TN_espresso))
PLOT <- ggplot(summary_data, aes(x=Tools, y=num_cnv, fill=cnv_status)) +
geom_bar(stat="identity", width=0.7, position=position_dodge(width=0.7)) +
geom_text(aes(label=num_cnv), vjust=0, size=6, position = position_dodge(width = 0.7)) +
theme(text = element_text(size=18)) + ylab("Number of predictions") +
theme(legend.position = c(0.85, 0.85),legend.background = element_rect(fill = "white", color = "black"), legend.title = 'none')) +
# A bar plot to show the reduction performance between and after CNV-espresso
plot_reduction_performance <- function(TP, TP_espresso, TN, TN_espresso){
summary_data <- data.frame(cnv_status=rep(c("True  Postive", "False Postive"), each=2),
Tools=rep(c("XHMM", "XHMM+CNVEspresso"),2),
num_cnv=c(TP, TP_espresso, TN, TN_espresso))
PLOT <- ggplot(summary_data, aes(x=Tools, y=num_cnv, fill=cnv_status)) +
geom_bar(stat="identity", width=0.7, position=position_dodge(width=0.7)) +
geom_text(aes(label=num_cnv), vjust=0, size=6, position = position_dodge(width = 0.7)) +
theme(text = element_text(size=18)) + ylab("Number of predictions") +
theme(legend.position = c(0.85, 0.85),legend.background = element_rect(fill = "white", color = "black"), legend.title = 'none') +
scale_fill_manual(values=c(hue_pal()(3)[3], hue_pal()(3)[1]))
return(PLOT)
}
fig_redu_canvas <- plot_reduction_performance(TP_canvas, TP_canvas_espresso, TN_canvas, TN_canvas_espresso)
fig_redu_canvas
# A bar plot to show the reduction performance between and after CNV-espresso
plot_reduction_performance <- function(TP, TP_espresso, TN, TN_espresso){
summary_data <- data.frame(cnv_status=rep(c("True  Postive", "False Postive"), each=2),
Tools=rep(c("XHMM", "XHMM+CNVEspresso"),2),
num_cnv=c(TP, TP_espresso, TN, TN_espresso))
PLOT <- ggplot(summary_data, aes(x=Tools, y=num_cnv, fill=cnv_status)) +
geom_bar(stat="identity", width=0.7, position=position_dodge(width=0.7)) +
geom_text(aes(label=num_cnv), vjust=0, size=6, position = position_dodge(width = 0.7)) +
theme(text = element_text(size=18)) + ylab("Number of predictions") +
theme(legend.position = c(0.85, 0.85),
legend.background = element_rect(fill = "white", color = "black"),
legend.title = element_blank()) +
scale_fill_manual(values=c(hue_pal()(3)[3], hue_pal()(3)[1]))
return(PLOT)
}
fig_redu_canvas <- plot_reduction_performance(TP_canvas, TP_canvas_espresso, TN_canvas, TN_canvas_espresso)
fig_redu_canvas
# A bar plot to show the reduction performance between and after CNV-espresso
plot_reduction_performance <- function(TP, TP_espresso, TN, TN_espresso){
summary_data <- data.frame(cnv_status=rep(c("True  Postive", "False Postive"), each=2),
Tools=rep(c("XHMM", "XHMM+CNVEspresso"),2),
num_cnv=c(TP, TP_espresso, TN, TN_espresso))
PLOT <- ggplot(summary_data, aes(x=Tools, y=num_cnv, fill=cnv_status)) +
geom_bar(stat="identity", width=0.7, position=position_dodge(width=0.7)) +
geom_text(aes(label=num_cnv), vjust=0, size=6, position = position_dodge(width = 0.7)) +
theme(text = element_text(size=18)) + ylab("Number of predictions") +
theme(legend.position = c(0.85, 0.85),
legend.background = element_rect(), #fill = "white", color = "black"
legend.title = element_blank()) +
scale_fill_manual(values=c(hue_pal()(3)[3], hue_pal()(3)[1]))
return(PLOT)
}
fig_redu_canvas <- plot_reduction_performance(TP_canvas, TP_canvas_espresso, TN_canvas, TN_canvas_espresso)
fig_redu_canvas
# A bar plot to show the reduction performance between and after CNV-espresso
plot_reduction_performance <- function(TP, TP_espresso, TN, TN_espresso){
summary_data <- data.frame(cnv_status=rep(c("True  Postive", "False Postive"), each=2),
Tools=rep(c("XHMM", "XHMM+CNVEspresso"),2),
num_cnv=c(TP, TP_espresso, TN, TN_espresso))
PLOT <- ggplot(summary_data, aes(x=Tools, y=num_cnv, fill=cnv_status)) +
geom_bar(stat="identity", width=0.7, position=position_dodge(width=0.7)) +
geom_text(aes(label=num_cnv), vjust=0, size=6, position = position_dodge(width = 0.7)) +
theme(text = element_text(size=18)) + ylab("Number of predictions") +
theme(legend.position = c(0.85, 0.85),
legend.background = element_rect(fill = "white", color = "black"),
legend.title = element_blank()) +
scale_fill_manual(values=c(hue_pal()(3)[3], hue_pal()(3)[1]))
return(PLOT)
}
# A bar plot to show the reduction performance between and after CNV-espresso
plot_reduction_performance <- function(TP, TP_espresso, TN, TN_espresso){
summary_data <- data.frame(cnv_status=rep(c("True  Postive", "False Postive"), each=2),
Tools=rep(c("XHMM", "XHMM+CNVEspresso"),2),
num_cnv=c(TP, TP_espresso, TN, TN_espresso))
PLOT <- ggplot(summary_data, aes(x=Tools, y=num_cnv, fill=cnv_status)) +
geom_bar(stat="identity", width=0.7, position=position_dodge(width=0.7)) +
geom_text(aes(label=num_cnv), vjust=0, size=6, position = position_dodge(width = 0.7)) +
theme(text = element_text(size=18)) + ylab("Number of predictions") +
theme(legend.position = c(0.85, 0.9),
legend.background = element_rect(fill = "white", color = "black"),
legend.title = element_blank()) +
scale_fill_manual(values=c(hue_pal()(3)[3], hue_pal()(3)[1]))
return(PLOT)
}
fig_redu_canvas <- plot_reduction_performance(TP_canvas, TP_canvas_espresso, TN_canvas, TN_canvas_espresso)
fig_redu_canvas
# A bar plot to show the reduction performance between and after CNV-espresso
plot_reduction_performance <- function(TP, TP_espresso, TN, TN_espresso){
summary_data <- data.frame(cnv_status=rep(c("True  Postive", "False Postive"), each=2),
Tools=rep(c("XHMM", "XHMM+CNVEspresso"),2),
num_cnv=c(TP, TP_espresso, TN, TN_espresso))
PLOT <- ggplot(summary_data, aes(x=Tools, y=num_cnv, fill=cnv_status)) +
geom_bar(stat="identity", width=0.7, position=position_dodge(width=0.7)) +
geom_text(aes(label=num_cnv), vjust=0, size=6, position = position_dodge(width = 0.7)) +
theme(text = element_text(size=18)) + ylab("Number of predictions") +
theme(legend.position = c(0.85, 0.87),
legend.background = element_rect(fill = "white", color = "black"),
legend.title = element_blank()) +
scale_fill_manual(values=c(hue_pal()(3)[3], hue_pal()(3)[1]))
return(PLOT)
}
fig_redu_canvas <- plot_reduction_performance(TP_canvas, TP_canvas_espresso, TN_canvas, TN_canvas_espresso)
fig_redu_canvas
combo <- grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, fig_redu_canvas,  nrow=1, ncol =3)
ggsave("./plots/combo.pdf", combo, width=20, height=5, unit="in")
combo
ggsave("./plots/combo.pdf", combo, width=15, height=5, unit="in")
combo
combo <- grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, fig_redu_canvas,  nrow=1, ncol =3)
combo
combo
combo <- grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, fig_redu_canvas,  nrow=1, ncol =3)
plot_ppv_numTargets_unionAsTP <- plot_ppv_numTargets(rare_cnv_df)
plot_ppv_vs_cnvFreq_all <- plot_ppv_cnvfreq(cnv_df)
combo <- grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, fig_redu_canvas,  nrow=1, ncol =3)
combo <- grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, fig_redu_canvas,  nrow=1, ncol =3)
combo <- grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, fig_redu_canvas,  nrow=1, ncol =3)
combo <- grid.arrange(plot_ppv_numTargets_unionAsTP, plot_ppv_vs_cnvFreq_all, fig_redu_canvas,  nrow=1, ncol =3)
